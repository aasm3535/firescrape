<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Playground - FireScrape</title>
  <link rel="stylesheet" href="/style.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        container: { center: true, padding: "2rem", screens: { "2xl": "1400px" } },
        extend: {
          colors: {
            border: "hsl(var(--border))",
            input: "hsl(var(--input))",
            ring: "hsl(var(--ring))",
            background: "hsl(var(--background))",
            foreground: "hsl(var(--foreground))",
            primary: { DEFAULT: "hsl(var(--primary))", foreground: "hsl(var(--primary-foreground))" },
            secondary: { DEFAULT: "hsl(var(--secondary))", foreground: "hsl(var(--secondary-foreground))" },
            muted: { DEFAULT: "hsl(var(--muted))", foreground: "hsl(var(--muted-foreground))" },
            accent: { DEFAULT: "hsl(var(--accent))", foreground: "hsl(var(--accent-foreground))" },
            card: { DEFAULT: "hsl(var(--card))", foreground: "hsl(var(--card-foreground))" },
          },
          borderRadius: { lg: "var(--radius)", md: "calc(var(--radius) - 2px)", sm: "calc(var(--radius) - 4px)" },
        },
      },
    }
  </script>
</head>
<body class="min-h-screen bg-background font-sans antialiased flex flex-col">

  <header class="sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur">
    <div class="container flex h-14 items-center">
      <a href="/" class="mr-6 flex items-center space-x-2 font-bold">
        <i data-lucide="box" class="h-5 w-5"></i>
        <span>FireScrape</span>
      </a>
      <div class="ml-auto flex items-center space-x-2">
        <button onclick="toggleTheme()" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground h-9 w-9">
            <i data-lucide="moon" id="theme-icon" class="h-4 w-4"></i>
        </button>
      </div>
    </div>
  </header>

  <main class="flex-1 container py-6">
    <div class="grid grid-cols-1 md:grid-cols-[250px_1fr] gap-6">
      
      <!-- Sidebar -->
      <aside class="flex flex-col gap-4">
        <div class="flex flex-col gap-1">
           <h4 class="text-sm font-medium leading-none mb-2 text-muted-foreground">Mode</h4>
           <button onclick="setMode('scrape')" id="nav-scrape" class="justify-start inline-flex items-center rounded-md text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2 bg-secondary text-secondary-foreground w-full">
              <i data-lucide="globe" class="mr-2 h-4 w-4"></i> Scrape
           </button>
           <button onclick="setMode('search')" id="nav-search" class="justify-start inline-flex items-center rounded-md text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2 w-full">
              <i data-lucide="search" class="mr-2 h-4 w-4"></i> Search
           </button>
        </div>
        
        <div class="flex flex-col gap-1">
           <h4 class="text-sm font-medium leading-none mb-2 text-muted-foreground">Language</h4>
           <select onchange="changeLang(this.value)" id="langSwitcher" class="flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50">
             <option value="en">English</option>
             <option value="ru">Русский</option>
           </select>
        </div>
      </aside>

      <!-- Main -->
      <div class="flex flex-col gap-4">
        <div class="flex w-full items-center space-x-2">
            <input id="inputField" class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50" placeholder="https://example.com" onkeydown="if(event.key==='Enter') executeApi()">
            <button onclick="executeApi()" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2">
              Run
            </button>
        </div>

        <div class="rounded-xl border bg-card text-card-foreground shadow">
            <div class="flex flex-col space-y-1.5 p-6 border-b">
                <div class="flex items-center justify-between">
                   <h3 class="font-semibold leading-none tracking-tight">Response</h3>
                   <span id="status-badge" class="hidden inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80">200 OK</span>
                </div>
            </div>
            <div class="p-0">
               <pre id="view-json" class="p-4 overflow-auto max-h-[500px] text-sm font-mono rounded-b-xl">Waiting for request...</pre>
            </div>
        </div>
      </div>

    </div>
  </main>

  <script>
    lucide.createIcons();
    let currentMode = 'scrape';

    function setMode(mode) {
      currentMode = mode;
      document.querySelectorAll('#nav-scrape, #nav-search').forEach(el => {
        el.classList.remove('bg-secondary', 'text-secondary-foreground');
        el.classList.add('hover:bg-accent');
      });
      document.getElementById('nav-' + mode).classList.add('bg-secondary', 'text-secondary-foreground');
      
      const input = document.getElementById('inputField');
      input.placeholder = mode === 'scrape' ? "https://example.com" : "search query...";
    }

    async function executeApi() {
      const input = document.getElementById('inputField').value;
      if (!input) return;
      
      const pre = document.getElementById('view-json');
      pre.innerHTML = 'Processing...';
      
      try {
        const endpoint = currentMode === 'scrape' ? `/api/scrape?url=${encodeURIComponent(input)}` : `/api/search?q=${encodeURIComponent(input)}`;
        const res = await fetch(endpoint);
        const data = await res.json();
        
        const badge = document.getElementById('status-badge');
        badge.classList.remove('hidden');
        badge.innerText = `${res.status} ${res.statusText}`;

        pre.innerHTML = JSON.stringify(data, null, 2);
      } catch (e) {
        pre.innerText = "Error: " + e.message;
      }
    }

    // Theme & Lang
    function toggleTheme() {
        const isDark = document.documentElement.classList.toggle('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        updateThemeIcon();
    }
    function updateThemeIcon() {
        const isDark = document.documentElement.classList.contains('dark');
        document.getElementById('theme-icon').setAttribute('data-lucide', isDark ? 'sun' : 'moon');
        lucide.createIcons();
    }
    const savedTheme = localStorage.getItem('theme');
    const sysDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (savedTheme === 'dark' || (!savedTheme && sysDark)) document.documentElement.classList.add('dark');
    updateThemeIcon();

    function changeLang(lang) { localStorage.setItem('lang', lang); }
    const savedLang = localStorage.getItem('lang') || 'en';
    document.getElementById('langSwitcher').value = savedLang;
  </script>
</body>
</html>